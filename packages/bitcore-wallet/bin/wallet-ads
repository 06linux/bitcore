#!/usr/bin/env node

var _ = require('lodash');
var program = require('commander');
var utils = require('./cli-utils');
program = utils.configureCommander(program);

// options, (isAdActive, isCurrentlyTesting)
program
  .usage('[options] [name] [title] [body] [imgUrl] [linkText] [linkUrl] [app] [dismissible] [isAdActive] [isTesting]')
  .parse(process.argv);

var args = program.args;
var host = 'http://localhost:3232/bws/api/';

var clientArgs = {
  host
}

var name = args[0]
var title = args[1];
var body = args[2];
var imgUrl = args[3];
var linkText = args[4];
var linkUrl = args[5];
var app = args[6];
var dismissible = args[7];
var isAdActive = args[8];
var isTesting = args[9]
var isAdActive = true;

let adArgs = {
  name,
  title,
  body,
  imgUrl,
  linkText,
  linkUrl,
  app,
  dismissible,
  isAdActive,
  isTesting
};

utils.getClient(clientArgs, { 
  mustExist: true, 
  walletId: 'f48d485b-66f8-40d0-9db2-24fa0f707ea6'
}, function (client) {
  client.createAdvertisement(adArgs, (err, result) => {
    utils.die(err);
    if(!result) {
      console.log('Couldn\'t create advertisement');
    }
    else {
      console.log('Created advertisement ', result);
    }
  });
});